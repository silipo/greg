package it.istat.dcit.itc.greg;

import it.istat.dcit.itc.greg.dto.RuleDTO;
import it.istat.dcit.itc.greg.model.Rule;
import it.istat.dcit.itc.greg.service.CheckService;
import it.istat.dcit.itc.greg.service.ParsingService;
import org.junit.Before;
import org.junit.Test;

import javax.script.ScriptException;
import java.io.IOException;
import java.io.Reader;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import static org.junit.Assert.assertTrue;

/**
 * Test rules
 */
public class CheckValidationTest {

    private CheckService srv;

    private List<Rule> rules;
    private List<String> data;

    private Reader validation;


    @Before
    public void setup()throws IOException, ScriptException  {
        srv = new CheckService();
        rules = new ArrayList<>();
        data = new ArrayList<>();
        validation = ParsingService.parseValidations(CheckValidationTest.class.getResource("/validation.js"));
        //header
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");        //oppure
        //data = ParsingService.parse(ParsingServiceTest.class.getResource("/residenziale.csv"));
    }


    @Test
    /*
    Più riquadri compilati
     */
    public void testError110(){
        rules.add(new Rule("110", "checkError110( '[[ABITAZIONI]]','[[STANZE]]','[[ACCESSORI]]','[[PIANI]]','[[VOLUME]]','[[SUP_TOTALE]]','[[SUP_UTILE]]','[[SUP_ESTERNI]]','[[SUP_AGRICOLTURA]]','[[SUP_INDUSTRIA]]','[[SUP_COMMERCIO]]','[[SUP_SERVIZI]]','[[SUP_ALTRO]]','[[TOTALE_SUPERFICE]]','[[S1_45]]','[[S2_45]]','[[S3_45]]','[[S4_45]]','[[S5_45]]','[[S6_45]]','[[S1_75]]','[[S2_75]]','[[2.7.31]]','[[S4_75]]','[[S5_75]]','[[S6_75]]','[[S1_110]]','[[S2_110]]','[[S3_110]]','[[S4_110]]','[[S5_110]]','[[S6_110]]','[[S1_O110]]','[[S2_O110]]','[[S3_O110]]','[[S4_O110]]','[[S5_O110]]','[[S6_O110]]','[[TOTALE_TABELLA]]','[[SOPRAELE]]','[[VOLUME_AMP]]','[[SUP_TOTALE_AMP]]','[[ABITAZIONI_AMP]]','[[STANZE_AMP]]','[[ACCESSORI_AMP]]','[[SUP_UTILE_AMP]]','[[STANZE_AMP2]]','[[ACCESSORI_AMP2]]','[[SUP_UTILE_AMP2]]','[[SUP_ESTERNI_AMP]]','[[SUP_PRODUTTIVO_AMP]]','[[NUOVO_AMPLI_COL]]','[[PIANI_COL]]','[[VOLUME_COL]]','[[SUP_TOTALE_COL]]','[[SUP_NONRES_COL]]' )", "",false));
        // correct
        data.add("07|2016|1|2121        |11|2014|11|2014|0000000|001|275|00015|00804|00004|01|00|0000|00000|00000|00|0000000|0000000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|0000|000000|000000|000000|000000|000000|000000|000000|000000|0|0000000|0000000|0000|0000|0000|000000|0000|0000|00000000|000000|000000|0|00|0000000|0000000|000000|1|000|00|1");
        // wrong
        data.add("07|2016|1|2121        |11|2014|11|2014|0000000|001|275|00015|00804|00004|01|00|0000|00000|00000|00|0000000|0000000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|0000|000000|000000|000000|000000|000000|000000|000000|000000|0|0000040|0000013|0000|0000|0000|000000|0001|0000|000011|000000|000000|0|00|0000000|0000000|000000|1|000|00|1");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 110 result should not be emtpy", results.size() == 1 );
    }

    @Test
    /*
    Nessun riquadro compilato
     */
    public void testError120(){
        rules.add(new Rule("120", "checkError120( '[[ABITAZIONI]]','[[STANZE]]','[[ACCESSORI]]','[[PIANI]]','[[VOLUME]]','[[SUP_TOTALE]]','[[SUP_UTILE]]','[[SUP_ESTERNI]]','[[SUP_AGRICOLTURA]]','[[SUP_INDUSTRIA]]','[[SUP_COMMERCIO]]','[[SUP_SERVIZI]]','[[SUP_ALTRO]]','[[TOTALE_SUPERFICE]]','[[S1_45]]','[[S2_45]]','[[S3_45]]','[[S4_45]]','[[S5_45]]','[[S6_45]]','[[S1_75]]','[[S2_75]]','[[S3_75]]','[[S4_75]]','[[S5_75]]','[[S6_75]]','[[S1_110]]','[[S2_110]]','[[S3_110]]','[[S4_110]]','[[S5_110]]','[[S6_110]]','[[S1_O110]]','[[S2_O110]]','[[S3_O110]]','[[S4_O110]]','[[S5_O110]]','[[S6_O110]]','[[TOTALE_TABELLA]]','[[SOPRAELE]]','[[VOLUME_AMP]]','[[SUP_TOTALE_AMP]]','[[ABITAZIONI_AMP]]','[[STANZE_AMP]]','[[ACCESSORI_AMP]]','[[SUP_UTILE_AMP]]','[[STANZE_AMP2]]','[[ACCESSORI_AMP2]]','[[SUP_UTILE_AMP2]]','[[SUP_ESTERNI_AMP]]','[[SUP_PRODUTTIVO_AMP]]','[[NUOVO_AMPLI_COL]]','[[PIANI_COL]]','[[VOLUME_COL]]','[[SUP_TOTALE_COL]]','[[SUP_NONRES_COL]]' )", "",false));
        // correct
        data.add("07|2016|1|2121        |11|2014|11|2014|0000000|001|275|00015|00804|00004|01|00|0000|00000|00000|00|0000000|0000000|000|000|000|000|000|000|000|123|000|000|000|000|000|000|000|123|000|000|000|000|000|000|000|000|0000|000000|000000|000000|000000|000000|000000|000000|000000|0|0000000|0000000|0000|0000|0000|000000|0000|0000|00000000|000000|000000|0|00|0000000|0000000|000000|1|000|00|1");
        // wrong
        data.add("07|2016|1|2121        |00|00|00|00|0000000|00|00|00|00|00|00|00|0000|00000|00000|00|0000000|0000000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|0000|000000|000000|000000|000000|000000|000000|000000|000000|0|0000000|0000000|0000|0000|0000|000000|0000|0000|00000000|000000|000000|0|00|0000000|0000000|000000|00|000|00|00");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 120 result should not be emtpy", results.size() == 1 );
    }

    @Test
    /*
    Data rilascio e Data ritiro omesse
     */
    public void testError230(){
        rules.add(new Rule("230", "checkError230('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", "",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|3|2004|6|2007|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO||||||||||||||||||||||||||||||||||||||||||||||||||||1|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO||2004|6|2007|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 130 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testError240(){
        rules.add(new Rule("240", "checkError240('[[ANNO_RITIRO]]')", "",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|3|2004|6|2007|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO||||||||||||||||||||||||||||||||||||||||||||||||||||1|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO||2004|6|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 140 result should not be emtpy", results.size() == 1 );
    }

    @Test
    /*
    Superfici non residenziali > 50% della Sup.Totale
     */
    public void testError410(){
        rules.add(new Rule("410", "checkError410( '[[ABITAZIONI]]','[[STANZE]]','[[ACCESSORI]]','[[PIANI]]','[[VOLUME]]','[[SUP_TOTALE]]','[[SUP_UTILE]]','[[SUP_ESTERNI]]','[[SUP_AGRICOLTURA]]','[[SUP_INDUSTRIA]]','[[SUP_COMMERCIO]]','[[SUP_SERVIZI]]','[[SUP_ALTRO]]','[[TOTALE_SUPERFICE]]','[[S1_45]]','[[S2_45]]','[[S3_45]]','[[S4_45]]','[[S5_45]]','[[S6_45]]','[[S1_75]]','[[S2_75]]','[[2.7.31]]','[[S4_75]]','[[S5_75]]','[[S6_75]]','[[S1_110]]','[[S2_110]]','[[S3_110]]','[[S4_110]]','[[S5_110]]','[[S6_110]]','[[S1_O110]]','[[S2_O110]]','[[S3_O110]]','[[S4_O110]]','[[S5_O110]]','[[S6_O110]]','[[TOTALE_TABELLA]]')", "",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|450|450||210|103|||TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|110|||210|103|||TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 200 result should not be emtpy", results.size() == 1 );
    }

    @Test
    /*
    Rapporto Piani/Abitazioni > 6
     */
    public void testError450(){
        rules.add(new Rule("450", "checkError450( '[[ABITAZIONI]]','[[STANZE]]','[[ACCESSORI]]','[[PIANI]]','[[VOLUME]]','[[SUP_TOTALE]]','[[SUP_UTILE]]','[[SUP_ESTERNI]]','[[SUP_AGRICOLTURA]]','[[SUP_INDUSTRIA]]','[[SUP_COMMERCIO]]','[[SUP_SERVIZI]]','[[SUP_ALTRO]]','[[TOTALE_SUPERFICE]]','[[S1_45]]','[[S2_45]]','[[S3_45]]','[[S4_45]]','[[S5_45]]','[[S6_45]]','[[S1_75]]','[[S2_75]]','[[2.7.31]]','[[S4_75]]','[[S5_75]]','[[S6_75]]','[[S1_110]]','[[S2_110]]','[[S3_110]]','[[S4_110]]','[[S5_110]]','[[S6_110]]','[[S1_O110]]','[[S2_O110]]','[[S3_O110]]','[[S4_O110]]','[[S5_O110]]','[[S6_O110]]','[[TOTALE_TABELLA]]')", "",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|21|STANZE|ACCESSORI|110|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|21|STANZE|ACCESSORI|140|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 450 result should not be emtpy", results.size() == 1 );
    }

    @Test
    /*
    Collettività - Piani omessi o piani > 15
     */
    public void testError610() {
        rules.add(new Rule("610", "checkError610('[[NUOVO_AMPLI_COL]]','[[PIANI_COL]]','[[VOLUME_COL]]','[[SUP_TOTALE_COL]]','[[SUP_NONRES_COL]]')", "",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|1|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|19|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 210 result should not be emtpy", results.size() == 1 );
    }

    @Test
    /*
    Collettività - Volume o Sup.Totale omessi
     */
    public void testError620() {
        rules.add(new Rule("410", "checkError620('[[NUOVO_AMPLI_COL]]','[[PIANI_COL]]','[[VOLUME_COL]]','[[SUP_TOTALE_COL]]','[[SUP_NONRES_COL]]')", "",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|1|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|0000|0000|00000|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 210 result should not be emtpy", results.size() == 1 );
    }

    @Test
    /*
    630 - Collettività - Volume / Sup.Totale <> 1,5 - 7
     */
    public void testError630() {
        rules.add(new Rule("630", "checkError630('[[NUOVO_AMPLI_COL]]','[[PIANI_COL]]','[[VOLUME_COL]]','[[SUP_TOTALE_COL]]','[[SUP_NONRES_COL]]')", "",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|1|1|20|10|1|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|1|1|100|10|1|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 210 result should not be emtpy", results.size() == 1 );
    }


    @Test
    /*
    Collettività - Sup.non residenziale > Sup.Totale
     */
    public void testError640() {
        rules.add(new Rule("640", "checkError640('[[NUOVO_AMPLI_COL]]','[[PIANI_COL]]','[[VOLUME_COL]]','[[SUP_TOTALE_COL]]','[[SUP_NONRES_COL]]')", "",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|1|1|20|10|1|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|1|1|10|20|100|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Error 210 result should not be emtpy", results.size() == 1 );
    }



    @Test
    public void testCorrection10(){
        rules.add(new Rule("10", "checkCorrection10('[[ANNO_RITIRO]]')", "getCorrection10Action()", false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|2016|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|2006|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 10 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection20(){
        rules.add(new Rule("20", "checkCorrection20('[[ANNO_RITIRO]]')", "getCorrection20Action()", false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|2002|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|2020|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 20 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection30(){
        rules.add(new Rule("30", "checkCorrection30('[[ANNO_RITIRO]]','[[MESE_RITIRO]]')", "getCorrection30Action()", false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|16|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 30 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection100(){
        rules.add(new Rule("100", "checkCorrection100('[[MESE_ELABORAZIONE]]','[[ANNO_ELABORAZIONE]]')", "getCorrection100Action('[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", false));
        // correct
        data.add("1|2017|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("z||TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 100 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection110(){
        rules.add(new Rule("110", "checkCorrection110('[[MESE_ELABORAZIONE]]','[[ANNO_ELABORAZIONE]]')", "getCorrection110Action()",false));
        // correct
        data.add("1|2016|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("81|2082|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 110 result should not be emtpy", results.size() == 1 );
    }

    /*
       TODO 120 - Mese e/o anno rilascio errati
     */
    @Test
    public void testCorrection120(){
        rules.add(new Rule("120", "checkCorrection120('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]')", "getCorrection120Action()",false));
        // correct
        data.add("1|2016|TITOLO|NUM_PERMESSO|12|2001|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("81|2082|TITOLO|NUM_PERMESSO|nov|2001|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 120 result should not be emtpy", results.size() == 1 );
    }
    
    /*
    130 - Mese e/o anno ritiro errati
     */
    @Test
    public void testCorrection130(){
        rules.add(new Rule("130", "checkCorrection130('[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", "getCorrection130Action()",false));
        // correct
        data.add("1|2016|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|01|2010|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("81|2082|TITOLO|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|gen|2010|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 130 result should not be emtpy", results.size() == 1 );
    }

    /*
    140 - Data rilascio > Data ritiro
     */
    @Test
    public void testCorrection140(){
        rules.add(new Rule("140", "checkCorrection140('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", "getCorrection140Action('[[TITOLO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|TITOLO|NUM_PERMESSO|5|2017|6|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|2|NUM_PERMESSO|3|2018|6|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|2|NUM_PERMESSO|3|2018|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 140 result should not be emtpy", results.size() == 2 );
    }

    /*
    150 - Data rilascio > Data ritiro
     */
    @Test
    public void testCorrection150(){
        rules.add(new Rule("150", "checkCorrection150('[[TITOLO]]','[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", "getCorrection150Action('[[MESE_RITIRO]]','[[ANNO_RITIRO]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|05|2015|04|2016|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|05|2015|04|2014|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 150 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection160(){
        rules.add(new Rule("160", "checkCorrection160('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", "getCorrection160Action('[[TITOLO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|2|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|2|NUM_PERMESSO|00|0000|02|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 160 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection170(){
        rules.add(new Rule("170", "checkCorrection170('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", "getCorrection170Action('[[TITOLO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|3|NUM_PERMESSO|00|0000|02|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 170 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection180(){
        rules.add(new Rule("180", "checkCorrection180('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", "getCorrection180Action('[[TITOLO]]','[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|2|NUM_PERMESSO|02|2000|00|0000|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 180 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection190(){
        rules.add(new Rule("190", "checkCorrection190('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]')", "getCorrection190Action('[[TITOLO]]','[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|02|2000|00|0000|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 190 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection235(){
        rules.add(new Rule("235", "checkCorrection235('[[TITOLO]]')", "getCorrection235Action()",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|0|NUM_PERMESSO|02|2000|00|0000|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|TITOLARE|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 235 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection240(){
        rules.add(new Rule("240", "checkCorrection240('[[TITOLO]]')", "getCorrection240Action('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]','[[TITOLARE]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|4|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|0|NUM_PERMESSO|02|2010|05|2010|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|3|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 240 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection245(){
        rules.add(new Rule("245", "checkCorrection245('[[TITOLO]]')", "getCorrection245Action('[[MESE_RILASCIO]]','[[ANNO_RILASCIO]]','[[MESE_RITIRO]]','[[ANNO_RITIRO]]','[[TITOLARE]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|4|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|0|NUM_PERMESSO|02|2010|05|2010|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|4|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 245 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection250(){
        rules.add(new Rule("250", "checkCorrection250('[[TITOLO]]','[[NUOVO_AMPLI_COL]]','[[PIANI_COL]]','[[VOLUME_COL]]','[[SUP_TOTALE_COL]]','[[SUP_NONRES_COL]]','[[TITOLARE]]')", "getCorrection250Action()",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|1|1|2|3|4|2|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|0|NUM_PERMESSO|02|2010|05|2010|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|2|1|2|3|4|4|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 250 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection260(){
        rules.add(new Rule("260", "checkCorrection260('[[PROGRESSIVO]]')", "getCorrection260Action()",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|5|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|1|1|2|3|4|2|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|0|NUM_PERMESSO|02|2010|05|2010|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|0|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|S3_75|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|2|1|2|3|4|4|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 260 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection270(){
        rules.add(new Rule("270", "checkCorrection270('[[ABITAZIONI]]','[[STANZE]]','[[ACCESSORI]]','[[PIANI]]','[[VOLUME]]','[[SUP_TOTALE]]','[[SUP_UTILE]]','[[SUP_ESTERNI]]','[[SUP_AGRICOLTURA]]','[[SUP_INDUSTRIA]]','[[SUP_COMMERCIO]]','[[SUP_SERVIZI]]','[[SUP_ALTRO]]','[[TOTALE_SUPERFICE]]','[[S1_45]]','[[S2_45]]','[[S3_45]]','[[S4_45]]','[[S5_45]]','[[S6_45]]','[[S1_75]]','[[S2_75]]','[[S3_75]]','[[S4_75]]','[[S5_75]]','[[S6_75]]','[[S1_110]]','[[S2_110]]','[[S3_110]]','[[S4_110]]','[[S5_110]]','[[S6_110]]','[[S1_O110]]','[[S2_O110]]','[[S3_O110]]','[[S4_O110]]','[[S5_O110]]','[[S6_O110]]','[[TOTALE_TABELLA]]')", "getCorrection270Action('[[ABITAZIONI]]','[[S1_45]]','[[S2_45]]','[[S3_45]]','[[S4_45]]','[[S5_45]]','[[S6_45]]','[[S1_75]]','[[S2_75]]','[[S3_75]]','[[S4_75]]','[[S5_75]]','[[S6_75]]','[[S1_110]]','[[S2_110]]','[[S3_110]]','[[S4_110]]','[[S5_110]]','[[S6_110]]','[[S1_O110]]','[[S2_O110]]','[[S3_O110]]','[[S4_O110]]','[[S5_O110]]','[[S6_O110]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|5|5|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|5|23|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|1|1|2|3|4|2|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|0|NUM_PERMESSO|02|2010|05|2010|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|0|5|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|0|0|0|0|0|0|1|1|1|0|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0000|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|2|1|2|3|4|4|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 270 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection300(){
        rules.add(new Rule("300", "checkCorrection300('[[ABITAZIONI]]','[[STANZE]]','[[ACCESSORI]]','[[PIANI]]','[[VOLUME]]','[[SUP_TOTALE]]','[[SUP_UTILE]]','[[SUP_ESTERNI]]','[[SUP_AGRICOLTURA]]','[[SUP_INDUSTRIA]]','[[SUP_COMMERCIO]]','[[SUP_SERVIZI]]','[[SUP_ALTRO]]','[[TOTALE_SUPERFICE]]','[[S1_45]]','[[S2_45]]','[[S3_45]]','[[S4_45]]','[[S5_45]]','[[S6_45]]','[[S1_75]]','[[S2_75]]','[[S3_75]]','[[S4_75]]','[[S5_75]]','[[S6_75]]','[[S1_110]]','[[S2_110]]','[[S3_110]]','[[S4_110]]','[[S5_110]]','[[S6_110]]','[[S1_O110]]','[[S2_O110]]','[[S3_O110]]','[[S4_O110]]','[[S5_O110]]','[[S6_O110]]','[[TOTALE_TABELLA]]')", "getCorrection300Action('[[ABITAZIONI]]','[[STANZE]]','[[ACCESSORI]]','[[PIANI]]','[[VOLUME]]','[[SUP_TOTALE]]','[[SUP_UTILE]]','[[SUP_ESTERNI]]','[[SUP_AGRICOLTURA]]','[[SUP_INDUSTRIA]]','[[SUP_COMMERCIO]]','[[SUP_SERVIZI]]','[[SUP_ALTRO]]','[[TOTALE_SUPERFICE]]','[[S1_45]]','[[S2_45]]','[[S3_45]]','[[S4_45]]','[[S5_45]]','[[S6_45]]','[[S1_75]]','[[S2_75]]','[[S3_75]]','[[S4_75]]','[[S5_75]]','[[S6_75]]','[[S1_110]]','[[S2_110]]','[[S3_110]]','[[S4_110]]','[[S5_110]]','[[S6_110]]','[[S1_O110]]','[[S2_O110]]','[[S3_O110]]','[[S4_O110]]','[[S5_O110]]','[[S6_O110]]','[[TOTALE_TABELLA]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|1|2017|1|2017|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|5|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|1|1|2|3|4|2|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|0|NUM_PERMESSO|02|2010|05|2010|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|0|0|0|2|3|VOLUME|SUP_TOTALE|0|0|0|0|0|0|1|1|1|0|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0000|0|200|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|2|1|2|3|4|4|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 300 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection330(){
        rules.add(new Rule("330", "checkCorrection330('[[SOPRAELE]]','[[VOLUME_AMP]]','[[SUP_TOTALE_AMP]]','[[ABITAZIONI_AMP]]','[[STANZE_AMP]]','[[ACCESSORI_AMP]]','[[SUP_UTILE_AMP]]','[[STANZE_AMP2]]','[[ACCESSORI_AMP2]]','[[SUP_UTILE_AMP2]]','[[SUP_ESTERNI_AMP]]','[[SUP_PRODUTTIVO_AMP]]')", "getCorrection330Action('[[SOPRAELE]]','[[VOLUME_AMP]]','[[SUP_TOTALE_AMP]]','[[ABITAZIONI_AMP]]','[[STANZE_AMP]]','[[ACCESSORI_AMP]]','[[SUP_UTILE_AMP]]','[[STANZE_AMP2]]','[[ACCESSORI_AMP2]]','[[SUP_UTILE_AMP2]]','[[SUP_ESTERNI_AMP]]','[[SUP_PRODUTTIVO_AMP]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|3|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|0|0|0|0|0|0|0|0|0|0|0|0|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|1|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|3|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|1|2|3|4|5|6|7|5|6|7|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL||CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 330 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection340(){
        rules.add(new Rule("340", "checkCorrection340('[[SOPRAELE]]','[[VOLUME_AMP]]','[[SUP_TOTALE_AMP]]','[[ABITAZIONI_AMP]]','[[STANZE_AMP]]','[[ACCESSORI_AMP]]','[[SUP_UTILE_AMP]]','[[STANZE_AMP2]]','[[ACCESSORI_AMP2]]','[[SUP_UTILE_AMP2]]','[[SUP_ESTERNI_AMP]]','[[SUP_PRODUTTIVO_AMP]]')", "getCorrection340Action('[[SOPRAELE]]','[[VOLUME_AMP]]','[[SUP_TOTALE_AMP]]','[[ABITAZIONI_AMP]]','[[STANZE_AMP]]','[[ACCESSORI_AMP]]','[[SUP_UTILE_AMP]]','[[STANZE_AMP2]]','[[ACCESSORI_AMP2]]','[[SUP_UTILE_AMP2]]','[[SUP_ESTERNI_AMP]]','[[SUP_PRODUTTIVO_AMP]]')",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|3|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0||CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|3|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|1|2|3|4|1|1|7|0|0|0|0|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL||CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 340 result should not be emtpy", results.size() == 1 );
    }

//    @Test
//    public void testCorrection345(){
//        rules.add(new Rule("345", "checkCorrection345('[[SOPRAELE]]','[[VOLUME_AMP]]','[[SUP_TOTALE_AMP]]','[[ABITAZIONI_AMP]]','[[STANZE_AMP]]','[[ACCESSORI_AMP]]','[[SUP_UTILE_AMP]]','[[STANZE_AMP2]]','[[ACCESSORI_AMP2]]','[[SUP_UTILE_AMP2]]','[[SUP_ESTERNI_AMP]]','[[SUP_PRODUTTIVO_AMP]]')", "getCorrection345Action('[[SOPRAELE]]','[[VOLUME_AMP]]','[[SUP_TOTALE_AMP]]','[[ABITAZIONI_AMP]]','[[STANZE_AMP]]','[[ACCESSORI_AMP]]','[[SUP_UTILE_AMP]]','[[STANZE_AMP2]]','[[ACCESSORI_AMP2]]','[[SUP_UTILE_AMP2]]','[[SUP_ESTERNI_AMP]]','[[SUP_PRODUTTIVO_AMP]]')",false));
//        // correct
//        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|3|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|3|0|0|0|0|1|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
//        // wrong
//        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|3|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|0|2|3|4|5||CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
//        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
//        assertTrue("Rule 345 result should not be emtpy", results.size() == 1 );
//    }

    @Test
    public void testCorrection370(){
        rules.add(new Rule("370", "checkCorrection370('[[TITOLARE]]','[[TITOLO]]')", "getCorrection370Action()",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|1|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|3|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL||CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 370 result should not be emtpy", results.size() == 1 );
    }

    @Test
    public void testCorrection380(){
        rules.add(new Rule("380", "checkCorrection380('[[TITOLARE]]','[[TITOLO]]')", "getCorrection380Action()",false));
        // correct
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|1|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL|1|CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        // wrong
        data.add("MESE_ELABORAZIONE|ANNO_ELABORAZIONE|2|NUM_PERMESSO|MESE_RILASCIO|ANNO_RILASCIO|MESE_RITIRO|ANNO_RITIRO|SEZIONE|COD_PRO|COD_COM|FOGLIO|PARTICELLA|SUBALT|DURATA|PROGRESSIVO|ABITAZIONI|STANZE|ACCESSORI|PIANI|VOLUME|SUP_TOTALE|S1_45|S5_45|2.7.31|S1_110|S5_110|S3_O110|S2_45|S6_45|S4_75|S2_110|S6_110|S4_O110|S3_45|S1_75|S5_75|S3_110|S1_O110|S5_O110|S4_45|S2_75|S6_75|S4_110|S2_O110|S6_O110|TOTALE_TABELLA|SUP_UTILE|SUP_ESTERNI|SUP_AGRICOLTURA|SUP_INDUSTRIA|SUP_COMMERCIO|SUP_SERVIZI|SUP_ALTRO|TOTALE_SUPERFICE|SOPRAELE|VOLUME_AMP|SUP_TOTALE_AMP|ABITAZIONI_AMP|STANZE_AMP|ACCESSORI_AMP|SUP_UTILE_AMP|STANZE_AMP2|ACCESSORI_AMP2|SUP_UTILE_AMP2|SUP_ESTERNI_AMP|SUP_PRODUTTIVO_AMP|NUOVO_AMPLI_COL|PIANI_COL|VOLUME_COL|SUP_TOTALE_COL|SUP_NONRES_COL||CONS_ENERGETICO|RAPP_FORMA|PIANO_CASA");
        Map<String, List<RuleDTO>> results  = srv.performCheck(data, rules, validation, null);
        assertTrue("Rule 380 result should not be emtpy", results.size() == 1 );
    }

}
